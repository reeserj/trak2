(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7961],{36345:function(e,t,s){Promise.resolve().then(s.bind(s,38526))},38526:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return x}});var r=s(57437),a=s(18628),n=s(24033),l=s(2265),o=s(14958),i=s(83473),d=s(31580),c=s(45379),u=s(29072),m=s(49720);function x(){let{user:e,loading:t}=(0,a.useAuth)(),s=(0,n.useRouter)(),[x,g]=(0,l.useState)(""),[b,y]=(0,l.useState)({lastFiveDays:[]}),[h,p]=(0,l.useState)(!1),[f,w]=(0,l.useState)(!1),[j,v]=(0,l.useState)(1);(0,l.useEffect)(()=>{t||e||s.push("/")},[e,t,s]),(0,l.useEffect)(()=>{e&&(N(),S())},[e]);let N=async()=>{let t=(0,d.WU)(new Date,"yyyy-MM-dd"),s=new Date(t),r=new Date(t);r.setHours(23,59,59,999);let{data:a,error:n}=await o.O.from("entries").select("*").eq("user_id",e.id).eq("type","journal").gte("createdat",s.toISOString()).lte("createdat",r.toISOString()).single();n&&"PGRST116"!==n.code&&console.error("Error loading today's entry:",n),a?(g(a.content),p(!0),w(!0)):(p(!1),w(!1))},S=async()=>{let t=new Date,s=Array.from({length:5},(e,s)=>({date:(0,c.k)(t,s+1),key:"day".concat(s+1)})),r=[{date:(0,u.W)(t,1),key:"lastMonth"},{date:(0,m.e)(t,1),key:"lastYear"},{date:(0,m.e)(t,2),key:"twoYearsAgo"},{date:(0,m.e)(t,3),key:"threeYearsAgo"},{date:(0,m.e)(t,4),key:"fourYearsAgo"},{date:(0,m.e)(t,5),key:"fiveYearsAgo"}],a={lastFiveDays:[]};for(let{date:t}of s){let s=new Date((0,d.WU)(t,"yyyy-MM-dd")),r=new Date(s);r.setHours(23,59,59,999);let{data:n,error:l}=await o.O.from("entries").select("*").eq("user_id",e.id).eq("type","journal").gte("createdat",s.toISOString()).lte("createdat",r.toISOString()).single();l&&"PGRST116"!==l.code&&console.error("Error loading entry for ".concat((0,d.WU)(t,"MMM d"),":"),l),n&&a.lastFiveDays.push(n)}for(let{date:t,key:s}of r){let r=new Date((0,d.WU)(t,"yyyy-MM-dd")),n=new Date(r);n.setHours(23,59,59,999);let{data:l,error:i}=await o.O.from("entries").select("*").eq("user_id",e.id).eq("type","journal").gte("createdat",r.toISOString()).lte("createdat",n.toISOString()).single();i&&"PGRST116"!==i.code&&console.error("Error loading ".concat(s," entry:"),i),l&&(a[s]=l)}y(a)},k=async()=>{if(!x.trim())return;let t=new Date,s=new Date((0,d.WU)(t,"yyyy-MM-dd")),r=new Date(s);r.setHours(23,59,59,999);let{data:a}=await o.O.from("entries").select("id").eq("user_id",e.id).eq("type","journal").gte("createdat",s.toISOString()).lte("createdat",r.toISOString()).single();try{if(a){let{error:e}=await o.O.from("entries").update({content:x,updatedat:new Date().toISOString()}).eq("id",a.id);if(e)throw e}else{let t=crypto.randomUUID(),{error:s}=await o.O.from("entries").insert([{id:t,content:x,type:"journal",user_id:e.id,title:"Journal Entry - ".concat((0,d.WU)(new Date,"MMMM d, yyyy")),createdat:new Date().toISOString(),updatedat:new Date().toISOString()}]);if(s)throw s}p(!0),w(!0)}catch(e){console.error("Error saving entry:",e)}};if(t)return(0,r.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-brand-blue"})});let M=e=>(0,r.jsx)("div",{className:"prose prose-invert prose-sm sm:prose-base lg:prose-lg max-w-none",children:(0,r.jsx)(i.U,{components:{h1:e=>{let{...t}=e;return(0,r.jsx)("h1",{className:"text-xl sm:text-2xl font-bold mb-3 sm:mb-4 text-white",...t})},h2:e=>{let{...t}=e;return(0,r.jsx)("h2",{className:"text-lg sm:text-xl font-bold mb-2 sm:mb-3 text-white",...t})},h3:e=>{let{...t}=e;return(0,r.jsx)("h3",{className:"text-base sm:text-lg font-bold mb-2 text-white",...t})},p:e=>{let{...t}=e;return(0,r.jsx)("p",{className:"text-sm sm:text-base mb-3 sm:mb-4 text-gray-200",...t})},ul:e=>{let{...t}=e;return(0,r.jsx)("ul",{className:"text-sm sm:text-base list-disc list-inside mb-3 sm:mb-4 text-gray-200",...t})},ol:e=>{let{...t}=e;return(0,r.jsx)("ol",{className:"text-sm sm:text-base list-decimal list-inside mb-3 sm:mb-4 text-gray-200",...t})},li:e=>{let{...t}=e;return(0,r.jsx)("li",{className:"mb-1",...t})},a:e=>{let{...t}=e;return(0,r.jsx)("a",{className:"text-brand-blue hover:underline",...t})},blockquote:e=>{let{...t}=e;return(0,r.jsx)("blockquote",{className:"text-sm sm:text-base border-l-4 border-gray-500 pl-4 italic my-3 sm:my-4 text-gray-200",...t})},code:e=>{let{...t}=e;return(0,r.jsx)("code",{className:"text-sm sm:text-base bg-gray-800 px-1.5 sm:px-2 py-0.5 sm:py-1 rounded text-gray-200",...t})},pre:e=>{let{...t}=e;return(0,r.jsx)("pre",{className:"text-sm sm:text-base bg-gray-800 p-3 sm:p-4 rounded my-3 sm:my-4 overflow-x-auto text-gray-200",...t})}},children:e})}),O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return(0,r.jsxs)("div",{className:"bg-gray-900/40 backdrop-blur-sm rounded-lg p-4 sm:p-6",children:[(0,r.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-white mb-3 sm:mb-4",children:t}),e?M(e.content):(0,r.jsx)("p",{className:"text-sm sm:text-base text-gray-400",children:"No entry for this date"})]})};return(0,r.jsxs)("div",{className:"space-y-4 sm:space-y-6 p-4 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 sm:gap-0 mb-4 sm:mb-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white",children:"Journal"}),(0,r.jsx)("p",{className:"text-sm sm:text-base text-gray-600 dark:text-gray-400",children:"Reflect on your journey"})]}),(0,r.jsxs)("div",{className:"flex w-full sm:w-auto gap-2 sm:gap-4",children:[f&&(0,r.jsx)("button",{onClick:()=>p(!h),className:"flex-1 sm:flex-none px-4 py-2 bg-gray-800 text-white text-sm sm:text-base rounded-lg hover:bg-opacity-90 transition-all",children:h?"Edit":"Preview"}),(0,r.jsx)("button",{onClick:k,className:"flex-1 sm:flex-none px-4 py-2 bg-brand-blue text-white text-sm sm:text-base rounded-lg hover:bg-opacity-90 shadow-[0_0_15px_rgba(29,99,255,0.5)] hover:shadow-[0_0_20px_rgba(29,99,255,0.7)] transition-all duration-300",children:f?"Save Changes":"Create Entry"})]})]}),(0,r.jsxs)("div",{className:"bg-gray-900/40 backdrop-blur-sm rounded-lg p-4 sm:p-6",children:[(0,r.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-white mb-3 sm:mb-4",children:f?"Today's Entry":"Create Today's Entry"}),h?M(x):(0,r.jsx)("textarea",{value:x,onChange:e=>g(e.target.value),className:"w-full h-48 sm:h-64 px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white text-sm sm:text-base focus:ring-2 focus:ring-brand-blue focus:border-transparent resize-none",placeholder:f?"Write your thoughts here... (Markdown supported)":"Start writing today's entry... (Markdown supported)"})]}),(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-5 gap-4",children:Array.from({length:5},(e,t)=>{let s=(0,c.k)(new Date,t+1),a=b.lastFiveDays[t];return(0,r.jsxs)("div",{className:"bg-gray-900/40 backdrop-blur-sm rounded-lg p-4",children:[(0,r.jsx)("h3",{className:"text-base font-semibold text-white mb-3",children:(0,d.WU)(s,"MMMM d")}),a?M(a.content):(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"No entry for this date"})]},t)})}),(0,r.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[O(b.lastMonth,"Last Month"),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 sm:gap-4 items-center",children:[(0,r.jsx)("button",{onClick:()=>v(1),className:"px-3 sm:px-4 py-2 text-sm sm:text-base rounded-lg transition-all ".concat(1===j?"bg-brand-blue text-white":"bg-gray-800 text-gray-300"),children:"Last Year"}),(0,r.jsx)("button",{onClick:()=>v(2),className:"px-3 sm:px-4 py-2 text-sm sm:text-base rounded-lg transition-all ".concat(2===j?"bg-brand-blue text-white":"bg-gray-800 text-gray-300"),children:"Two Years Ago"}),(0,r.jsx)("button",{onClick:()=>v(3),className:"px-3 sm:px-4 py-2 text-sm sm:text-base rounded-lg transition-all ".concat(3===j?"bg-brand-blue text-white":"bg-gray-800 text-gray-300"),children:"Three Years Ago"}),(0,r.jsx)("button",{onClick:()=>v(4),className:"px-3 sm:px-4 py-2 text-sm sm:text-base rounded-lg transition-all ".concat(4===j?"bg-brand-blue text-white":"bg-gray-800 text-gray-300"),children:"Four Years Ago"}),(0,r.jsx)("button",{onClick:()=>v(5),className:"px-3 sm:px-4 py-2 text-sm sm:text-base rounded-lg transition-all ".concat(5===j?"bg-brand-blue text-white":"bg-gray-800 text-gray-300"),children:"Five Years Ago"})]}),1===j&&O(b.lastYear,"Last Year"),2===j&&O(b.twoYearsAgo,"Two Years Ago"),3===j&&O(b.threeYearsAgo,"Three Years Ago"),4===j&&O(b.fourYearsAgo,"Four Years Ago"),5===j&&O(b.fiveYearsAgo,"Five Years Ago")]})]})}},18628:function(e,t,s){"use strict";s.r(t),s.d(t,{AuthProvider:function(){return o},useAuth:function(){return i}});var r=s(57437),a=s(2265),n=s(14958);let l=(0,a.createContext)({user:null,loading:!0,signOut:async()=>{}});function o(e){let{children:t}=e,[s,o]=(0,a.useState)(null),[i,d]=(0,a.useState)(!0),c=async()=>{let{error:e}=await n.O.auth.signOut();if(e)throw console.error("Error signing out:",e),e};return(0,a.useEffect)(()=>{n.O.auth.getSession().then(e=>{var t;let{data:{session:s}}=e;o(null!==(t=null==s?void 0:s.user)&&void 0!==t?t:null),d(!1)});let{data:{subscription:e}}=n.O.auth.onAuthStateChange((e,t)=>{var s;o(null!==(s=null==t?void 0:t.user)&&void 0!==s?s:null),d(!1)});return()=>e.unsubscribe()},[]),(0,r.jsx)(l.Provider,{value:{user:s,loading:i,signOut:c},children:t})}let i=()=>(0,a.useContext)(l)},14958:function(e,t,s){"use strict";s.d(t,{O:function(){return o}});var r=s(54566);let a="https://dkvaspqbakjcwaxivtqo.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRrdmFzcHFiYWtqY3dheGl2dHFvIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzcxMjk4NzcsImV4cCI6MjA1MjcwNTg3N30.dcVtOCJWN17M9K5MFMk6cRNugze9Dw-JnlTniPrFONI\n";if(!a||!n)throw Error("Missing Supabase environment variables");let l=a.trim(),o=(0,r.eI)(l,n,{auth:{persistSession:!0,autoRefreshToken:!0},db:{schema:"public"}})}},function(e){e.O(0,[382,1082,1430,2971,4938,1744],function(){return e(e.s=36345)}),_N_E=e.O()}]);